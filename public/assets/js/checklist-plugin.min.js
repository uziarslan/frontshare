(function () {
  var mychecklist = (function () {
    "use strict";
    tinymce.PluginManager.add("myalignment", function (editor, url) {
      editor.ui.registry.addMenuButton("myalignment", {
        tooltip: "Update Alignment",
        text: "Alignment",
        fetch: function (callback) {
          var items = [
            {
              type: "menuitem",
              text: "Left",
              onAction: function (_) {
                editor.execCommand("JustifyLeft");
              },
            },
            {
              type: "menuitem",
              text: "Center",
              onAction: function (_) {
                editor.execCommand("JustifyCenter");
              },
            },
            {
              type: "menuitem",
              text: "Right",
              onAction: function (_) {
                editor.execCommand("JustifyRight");
              },
            },
            {
              type: "menuitem",
              text: "Justify",
              onAction: function (_) {
                editor.execCommand("JustifyFull");
              },
            },
          ];
          callback(items);
        },
      });
    });

    tinymce.PluginManager.add("mychecklist", function (editor, url) {
      /**
       * Plugin behaviour for when the Toolbar or Menu item is selected
       *
       * @private
       */
      function _onAction() {
        var content = `<ul class="tox-checklist">
                      <li class="tox-checklist--checked">Task</li>
                      </ul>`;

        editor.insertContent(content);
      }

      // Define the Toolbar button
      editor.ui.registry.addButton("mychecklist", {
        icon: "checklist",
        tooltip: "Insert check list",
        onAction: _onAction,
      });

      editor.on("NodeChange", function (event) {
        var node = editor.selection.getNode();
        var parent = node.parentElement;
        if (parent.className === "tox-checklist") {
          if (
            node.nodeName === "LI" &&
            node.className === "tox-checklist--checked"
          ) {
            node.className = "";
          } else if (node.nodeName === "LI" && node.className === "") {
            node.className = "tox-checklist--checked";
          }
        }
      });
    });
  })();
})();
